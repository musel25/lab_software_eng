classDef constraint fill:#f9f,stroke:#333,stroke-width:2px;
classDef functional fill:#bbf,stroke:#333,stroke-width:2px;

class SS11_1,SS11_5 constraint
class SS11_2,SS11_3,SS11_4,SS11_6,SS11_7,SS11_8,SS11_9,SS11_10,SS11_11,SS11_12,SS11_13,SS11_14,SS11_15,SS11_16,SS11_17 functional

flowchart TD
    %% MAIN SECURITY CONCEPT
    SS11_1["SS11-1: Two Independent Security Checks (Constraint)"]

    %% TWO SECURITY CHECKS
    SS11_1 --> SS11_2["SS11-2: Employee ID Card Identification - Entry (Functional Requirement)"]
    SS11_1 --> SS11_3["SS11-3: Employee ID Card Identification - Exit (Functional Requirement)"]
    SS11_1 --> SS11_4["SS11-4: Biometric Scan (Functional Requirement)"]
    SS11_1 --> SS11_5["SS11-5: Time Between Two Independent Checks (Constraint)"]
    SS11_5 --> SS11_6["SS11-6: Configure Time Between Two Independent Checks (Functional Requirement)"]

    %% CARD ATTEMPTS & FEEDBACK
    SS11_2 --> SS11_7["SS11-7: Three Attempts On Employee ID Entry (Functional Requirement)"]
    SS11_3 --> SS11_9["SS11-9: Three Attempts On Employee ID Exit (Functional Requirement)"]
    SS11_4 --> SS11_8["SS11-8: Three Attempts On Biometric Data Entry (Functional Requirement)"]

    SS11_7 --> SS11_14["SS11-14: Disabling User Account (Functional Requirement)"]
    SS11_8 --> SS11_14
    SS11_9 --> SS11_14

    %% DENIED ENTRY/EXIT HANDLING
    SS11_7 --> SS11_10["SS11-10: Denied Entry Notification (Functional Requirement)"]
    SS11_9 --> SS11_11["SS11-11: Denied Exit Notification (Functional Requirement)"]
    SS11_10 --> SS11_12["SS11-12: Alarm - Entry (Functional Requirement)"]
    SS11_11 --> SS11_13["SS11-13: Alarm - Exit (Functional Requirement)"]

    %% VISUAL FEEDBACK
    SS11_2 --> SS11_15["SS11-15: Visualization of Security Card Check Status - Entry (Functional Requirement)"]
    SS11_3 --> SS11_16["SS11-16: Visualization of Security Card Check Status - Exit (Functional Requirement)"]
    SS11_4 --> SS11_17["SS11-17: Visualization of Biometric Data Check Status (Functional Requirement)"]

    %% ADDITIONAL CARD AUTHORIZATION
    SS11_2 --> SS111_2["SS111-2: Authorization of Security Card - Entry (Functional Requirement)"]
    SS11_3 --> SS13_1["SS13-1: Authorization of Security Card - Exit (Functional Requirement)"]

    %% CARD VALIDITY
    SS111_2 --> SS111_3["SS111-3: Security Card Renewal (Functional Requirement)"]
    SS111_3 --> SS111_4["SS111-4: Out of Date Cards - Entry (Functional Requirement)"]
    SS111_3 --> SS111_5["SS111-5: Out of Date Cards - Exit (Functional Requirement)"]

    %% BIOMETRIC CHECKS
    SS11_4 --> SS112_1["SS112-1: Approval of Biometric Data (Functional Requirement)"]
    SS11_4 --> SS112_2["SS112-2: Biometric Data Storage (Constraint)"]

    %% USER PROCESSING AND TIMING
    SS12["SS12: User Processing and Timing Constraints"]
    SS12 --> SS12_1["SS12-1: Processing User Request (Constraint)"]
    SS12 --> SS12_2["SS12-2: Entry Time (Constraint)"]
    SS12 --> SS12_3["SS12-3: Exit Time (Constraint)"]
    SS12 --> SS12_4["SS12-4: Configure Entry and Exit Time (Functional Requirement)"]
    SS12 --> SS12_5["SS12-5: Automatic Securing the Secure Area - Entry (Functional Requirement)"]
    SS12 --> SS12_6["SS12-6: Automatic Securing the Secure Area - Exit (Functional Requirement)"]

    %% MONITORING ADDITIONS
    MA1_1["MA1-1: Image Capture (Functional Requirement)"]
    MA2["MA2: Time Monitoring"]
    MA2 --> MA2_1["MA2-1: Time Recording (Functional Requirement)"]
    MA2 --> MA2_2["MA2-2: Timelimit Violation (Functional Requirement)"]

    %% EMERGENCY OPERATIONS
    E1_1["E1-1: Emergency Exit (Functional Requirement)"]
    E2_1["E2-1: Security Lockdown (Functional Requirement)"]

    %% TOP-LEVEL CONNECTIONS
    SS11_1 --> SS12
    SS11_1 --> MA1_1
    SS11_1 --> MA2
    SS11_1 --> E1_1
    SS11_1 --> E2_1
